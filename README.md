# TR-03116-4-checklist
Das Skript checklist.py überprüft einen TLS-Server auf Konformität zu den Vorgaben [TR-03116-4](https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Publikationen/TechnischeRichtlinien/TR03116/BSI-TR-03116-4.pdf?__blob=publicationFile&v=2) des Bundesamtes für Sicherheit in der Informationstechnik (BSI) . Es orientiert sich dabei an den Vorgaben der zugehörigen [Checkliste](https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Publikationen/TechnischeRichtlinien/TR03116/TLS-Checkliste.pdf?__blob=publicationFile&v=2).

Es werden nicht alle Aspekte der Checkliste vollständig und automatisch geprüft. Die folgende Tabelle gibt einen Überblick.


| Anforderung | Beschreibung                                                                                                                                       | Prüfung umgesetzt?      | Hinweis                                                                                                                                                                                                                                                                                                                                         |
|:------------|:---------------------------------------------------------------------------------------------------------------------------------------------------|:------------------------|:------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 2.3.1       | Es werden nur erlaubte TLS-Versionen unterstützt                                                                                                   | Ja                      | Die Prüfung erfolgt durch eine Reihe von Verbindungsversuchen mit unterschiedlichen Cipher-Suites. Es wird die TLS-Library von python verwendet, die im Regelfall auf openssl zurückfällt.                                                                                                                                                      |
| 2.3.2       | Die verpflichtend zu unterstützenden Cipher Suites werden unterstützt.                                                                             | Ja, mit Einschränkungen | Die Prüfung erfolgt durch eine Reihe von Verbindungsversuchen mit unterschiedlichen TLS-Versionen. Es wird die TLS-Library von python verwendet, die im Regelfall auf openssl zurückfällt. Der Abgleich, ob die verpflichtenden Cipher-Suites umgesetzt wurden, muss allerdings manuell vorgenommen werden                                      |
| 2.3.3       | Es werden nur erlaubte Cipher-Suites unterstützt                                                                                                   | Ja                      | Die Prüfung erfolgt durch eine Reihe von Verbindungsversuchen mit unterschiedlichen Cipher-Suites. Es wird die TLS-Library von python verwendet, die im Regelfall auf openssl zurückfällt.                                                                                                                                                      |
| 2.3.4       | Die Priorisierung der Cipher Suites ist korrekt                                                                                                    | Ja, mit Einschränkungen | Die Prüfung erfolgt durch eine Reihe von Verbindungsversuchen mit unterschiedlichen Cipher-Suites. Es wird die TLS-Library von python verwendet, die im Regelfall auf openssl zurückfällt. Für unterstützte Cipher-Suites wird die Priorisierung mit ausgegeben. Der Abgleich mit den Vorgaben der Checkliste muss alledrings manuell erfolgen. |
| 2.4.1       | Die verwendeten ephemeren Parameter während des TLS-Handshakes bieten ausreichende Sicherheit                                                      | Nein                    | offen                                                                                                                                                                                                                                                                                                                                           |
| 2.4.2       | Für Signaturen während des TLS-Handshakes werden folgende Algorithmen verwendet                                                                    | Nein                    | Nein                      | Die Checkliste sieht für diesen Punkt explizit eine Prüfung der Konfigurationsdatei vor                                                                                                                                                                                                                             |
| 2.5.1       | Client-initiierte Session Renegotiation wird nicht unterstützt                                                                                     | Ja, mit Einschränkungen | Die Prüfung erfolgt durch einen direkten Aufruf der openssl Library da diese Funktionalität in Python nicht zugreifbar ist. Leider habe ich keinen Weg gefunden, zu überprüfen, ob ein Server Session-Renegotiation auch auf unsicherem Wege unterstützen würde sofern er bereits die Extension unterstützt                                     |
| 2.5.2       | TLS-Kompression wird nicht unterstützt                                                                                                             | Ja                      | Die Prüfung erfolgt durch einen direkten Aufruf der openssl Library mit Auswertung der Ausgabe                                                                                                                                                                                                                                                  |
| 2.5.3       | Die Heartbeat Extension wird nicht unterstützt                                                                                                     | Ja                      | Die Prüfung erfolgt durch einen direkten Aufruf der openssl Library mit Auswertung der Ausgabe                                                                                                                                                                                                                                                  |
| 2.5.4       | Die truncated_hmac Extension wird nicht unterstützt                                                                                                | Ja                      | Die Prüfung erfolgt durch einen direkten Aufruf der openssl Library mit Auswertung der Ausgabe                                                                                                                                                                                                                                                  |
| 2.6.1       | Es werden nur Cipher Suites mit „Perfect Forward Secrecy“ unterstützt. (Nur Cipher Suites die mit „TLS_ECDHE“ oder „TLS_DHE“ beginnen) (EMPFOHLEN) | Nein                    | Kriterium ist optional, aktuell nicht umgesetzt                                                                                                                                                                                                                                                                                                 |
| 2.6.2       | Die „Encrypt-then-MAC“-Extension wird unterstützt (EMPFOHLEN).                                                                                     | Nein                    | Kriterium ist optional, aktuell nicht umgesetzt                                                                                                                                                                                                                                                                                                 |
| 2.6.3       | OCSP-Stapling wird unterstützt (EMPFOHLEN)                                                                                                         | Nein                    | Kriterium ist optional, aktuell nicht umgesetzt                                                                                                                                                                                                                                                                                                 |
| 2.6.4       | Die „Extended-Master-Secret-Extension“ wird unterstützt (EMPFOHLEN).                                                                               | Nein                    | Kriterium ist optional, aktuell nicht umgesetzt                                                                                                                                                                                                                                                                                                 |
| 2.6.5       | Das Server-Zertifikat ist ein Extended-Validation-Zertifikat (EMPFOHLEN).                                                                          | Nein                    | Kriterium ist optional, aktuell nicht umgesetzt                                                                                                                                                                                                                                                                                                 |


## Systemvoraussetungen
* Python 2.7
* Installierte Python Pakete (pip install ...)
  * TLS
  * colorlog
* openssl binary (muss im Pfad liegen)
* SSLyze (muss im Pfad liegen)

##Disclaimmer
Der Code wurde grundlegend getestet aber aufgrund der Komplexität der Materie sollten die Ergebnisse des Skripts immer mit Vorsicht verwendet werden.

##Beiträge
Fragen, Anmerkungen und Kommentare sind herzlich willkommen. Am Liebsten nehme ich natürlich Beiträge als Pull-Request.
